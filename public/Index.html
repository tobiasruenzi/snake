<!DOCTYPE html>
<html>
<head>
<!-- Load the Paper.js library -->
<script type="text/javascript" src="js/dist/paper-full.js"></script>


<script type="text/paperscript" canvas="paper">
//console.log('entree dans le javascript');

ws = new WebSocket('wss://localhost:8999');
//console.log('server cree');

ws.onopen = function (event) 
{
  	//console.log('Connecte au server');
};

var color1 = new Color(Math.random(), Math.random(), Math.random());
var color2 = new Color(Math.random(), Math.random(), Math.random());
var myBall=[];
var Ball=[];
var monserpent;
var autreserpent;




var from = new Point(0, 0);
var to = new Point(1200, 800);
var rect = new Path.Rectangle(from, to);
rect.strokeColor = 'black';

var vectorDir =to* Point.random();
vectorDir.length = 5;


function onMouseDown(event) {
	vectorDir = event.point - myBall[0].position;
	vectorDir.length = 5;
	var message = { 
				type : "tete",
				x : vectorDir.x,
				y : vectorDir.y
			};
	ws.send(JSON.stringify(message));
console.log('tete envoyé');
}

function onFrame(event) {
ws.onmessage = function (message) 
{ 
	
	var msg = JSON.parse(message.data);

	
	switch(msg.type)
	{	
		case "creeserpents" :
			console.log( msg);
			monserpent = msg.Serpent1;
			autreserpent = msg.Serpent2;
			
			for (var i=0; i<monserpent.length;i++){
				var cercle=new Path.Circle(monserpent[i].x,monserpent[i].y, 20);
				cercle.fillColor= color1;
				cercle.fillColor.hue =  cercle.fillColor.hue + i;
				myBall.push(cercle);
				
			}
			for (var i=0; i<autreserpent.length;i++){
				var cercle=new Path.Circle(autreserpent[i].x,autreserpent[i].y, 20);
				cercle.fillColor= color2;
				cercle.fillColor.hue =  cercle.fillColor.hue + i;
				Ball.push(cercle);
				
			}

		case "majserpents" :
			//console.log( msg.Serpent1[0], msg.Serpent2[0]);
			
			for (var i=0; i< msg.Serpent1.length;i++){
				myBall[i].position.x = msg.Serpent1[i].x;
				myBall[i].position.y = msg.Serpent1[i].y;
			}
			for (var i=0; i< msg.Serpent2.length;i++){
				Ball[i].position.x = msg.Serpent2[i].x;
				Ball[i].position.y = msg.Serpent2[i].y;
			}
			
			
			
	}

};


}
	
console.log('dessin termine');
</script>

<title>this is the Game</title>
</head>
<body>

	<h1>Snakes</h1>
	<canvas id="paper" width="1200" height="800"></canvas>
</body>
</html>
