<!DOCTYPE html>
<html>
<head>
<!-- Load the Paper.js library -->
<script type="text/javascript" src="js/dist/paper-full.js"></script>


<script type="text/paperscript" canvas="paper">
//console.log('entree dans le javascript');

ws = new WebSocket('wss://localhost:8999');
//console.log('server cree');

ws.onopen = function (event) 
{
  	//console.log('Connecte au server');
};

var color = new Color(Math.random(), Math.random(), Math.random());
var myBall=[];
var Ball=[];
var monserpent;
var autreserpent;




var from = new Point(0, 0);
var to = new Point(1200, 800);
var rect = new Path.Rectangle(from, to);
rect.strokeColor = 'black';

var vectorDir =to* Point.random();
vectorDir.length = 5;

/*
function onMouseDown(event) {
	vectorDir = event.point - myBall[0].position;
	vectorDir.length = 5;

}*/

function onFrame(event) {
ws.onmessage = function (message) 
{ 
	console.log('message recus');
	var msg = JSON.parse(message.data);

	
	switch(msg.type)
	{	
		case "creeserpents" :
			console.log( msg);
			monserpent = msg.Serpent1;
			autreserpent = msg.Serpent2;
			
			for (var i=0; i<monserpent.length;i++){
				var cercle=new Path.Circle(monserpent[i].x,monserpent[i].y, 20);
				cercle.fillColor= color;
				cercle.fillColor.hue =  cercle.fillColor.hue + i;
				myBall.push(cercle);
				console.log(cercle.center, cercle.center);
			}
			for (var i=0; i<autreserpent.length;i++){
				var cercle=new Path.Circle(autreserpent[i].x,autreserpent[i].y, 20);
				cercle.fillColor= color;
				cercle.fillColor.hue =  cercle.fillColor.hue + i;
				Ball.push(cercle);
				console.log(cercle.center, cercle.center);
			}
			
	}

};
/*
	for (var i = myBall.length - 1; i > 0; i--) {
		var vectorDirsuiv = myBall[i - 1].position - myBall[i].position;
		vectorDirsuiv.length = 5;
		myBall[i].translate(vectorDirsuiv);
	}
	myBall[0].translate(vectorDir);*/
}
	
console.log('dessin termine');
</script>

<title>this is the Game</title>
</head>
<body>

	<h1>Snakes</h1>
	<canvas id="paper" width="1200" height="800"></canvas>
</body>
</html>
